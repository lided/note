import{_ as s,c as i,o as l,ag as e}from"./chunks/framework.DPDPlp3K.js";const n="/assets/Pasted%20image%2020240222131756.BJeaAmsR.png",t="/assets/Pasted%20image%2020240222133301.DyyYTIdn.png",g=JSON.parse('{"title":"性能分析","description":"","frontmatter":{},"headers":[],"relativePath":"database/mysql/SQL.md","filePath":"database/mysql/SQL.md"}'),h={name:"database/mysql/SQL.md"};function p(r,a,o,d,k,c){return l(),i("div",null,a[0]||(a[0]=[e(`<h2 id="分类" tabindex="-1">分类 <a class="header-anchor" href="#分类" aria-label="Permalink to &quot;分类&quot;">​</a></h2><h3 id="ddl-数据定义语言" tabindex="-1">DDL(数据定义语言) <a class="header-anchor" href="#ddl-数据定义语言" aria-label="Permalink to &quot;DDL(数据定义语言)&quot;">​</a></h3><p>create,alter,drop,rename,truncate清空</p><h3 id="dml-数据操作语言" tabindex="-1">DML(数据操作语言) <a class="header-anchor" href="#dml-数据操作语言" aria-label="Permalink to &quot;DML(数据操作语言)&quot;">​</a></h3><p>insert,delete,update,select</p><h3 id="dcl-数据控制语言" tabindex="-1">DCL(数据控制语言) <a class="header-anchor" href="#dcl-数据控制语言" aria-label="Permalink to &quot;DCL(数据控制语言)&quot;">​</a></h3><p>commit,rollback,savepoint,grant,revoke</p><h2 id="大小写规范" tabindex="-1">大小写规范 <a class="header-anchor" href="#大小写规范" aria-label="Permalink to &quot;大小写规范&quot;">​</a></h2><p>在<strong>windows</strong>下不区分大小写</p><p>在<strong>linux</strong>下<strong>数据库名,表名,表别名,变量名</strong>区分大小写,<strong>关键字,函数名,字段名,字段别名</strong>不区分大小写</p><p>是因为windows文件本身不区分大小写,而liunx区分</p><h2 id="注释" tabindex="-1">注释 <a class="header-anchor" href="#注释" aria-label="Permalink to &quot;注释&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>单行注释</span></span>
<span class="line"><span>--- 注释内容</span></span>
<span class="line"><span>#注释内容(mysql独有)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>多行</span></span>
<span class="line"><span>/*  注释内容  */</span></span></code></pre></div><h1 id="性能分析" tabindex="-1">性能分析 <a class="header-anchor" href="#性能分析" aria-label="Permalink to &quot;性能分析&quot;">​</a></h1><h2 id="慢查询日志" tabindex="-1">慢查询日志 <a class="header-anchor" href="#慢查询日志" aria-label="Permalink to &quot;慢查询日志&quot;">​</a></h2><h6 id="查看慢查询日志是否开启-默认关闭" tabindex="-1">查看慢查询日志是否开启(默认关闭) <a class="header-anchor" href="#查看慢查询日志是否开启-默认关闭" aria-label="Permalink to &quot;查看慢查询日志是否开启(默认关闭)&quot;">​</a></h6><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">show variables </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">like</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;slow_query_log&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>要想开启,在my.cnf中的[mysqld]下配置</p><div class="language-cnf vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cnf</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># 开启慢查询,查询语句超过2秒为慢</span></span>
<span class="line"><span>slow_query_log=1</span></span>
<span class="line"><span>long_query_time=2</span></span></code></pre></div><h2 id="explain-执行计划" tabindex="-1">explain(执行计划) <a class="header-anchor" href="#explain-执行计划" aria-label="Permalink to &quot;explain(执行计划)&quot;">​</a></h2><p>在sql语句前面加上explain关键字即可查看该sql执行计划</p><h1 id="sql优化" tabindex="-1">sql优化 <a class="header-anchor" href="#sql优化" aria-label="Permalink to &quot;sql优化&quot;">​</a></h1><h2 id="insert" tabindex="-1">insert <a class="header-anchor" href="#insert" aria-label="Permalink to &quot;insert&quot;">​</a></h2><ul><li><strong>批量插入</strong>(推荐1000条以内)</li><li><strong>手动开启事务</strong></li><li><strong>主键顺序插入</strong></li></ul><p>如果需要大批量(百万)插入数据,使用load指令</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- mysql连接时,使用--local-infile</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mysql </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">--local-infile -u root -p</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">--开启load功能</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> local_file </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 执行load</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">load</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> local</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/path/filename&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> into</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;table&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fields terminated </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;,&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> line</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> terminated </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;\\n&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h2 id="主键" tabindex="-1">主键 <a class="header-anchor" href="#主键" aria-label="Permalink to &quot;主键&quot;">​</a></h2><ul><li>满足要求的情况下尽量减少主键长度</li></ul><h2 id="order-by" tabindex="-1">order by <a class="header-anchor" href="#order-by" aria-label="Permalink to &quot;order by&quot;">​</a></h2><ul><li>order by 后的字段尽量为索引,并且遵循最左前缀法则</li><li>有多个字段时,多个字段排序方式应一致</li><li>也可以在创建索引时指定索引排序顺序 <img src="`+n+'" alt=""></li></ul><h2 id="group-by" tabindex="-1">group by <a class="header-anchor" href="#group-by" aria-label="Permalink to &quot;group by&quot;">​</a></h2><ul><li>group by 后的字段尽量为索引,并且遵循最左前缀法则</li></ul><h2 id="limit" tabindex="-1">limit <a class="header-anchor" href="#limit" aria-label="Permalink to &quot;limit&quot;">​</a></h2><p>mysql在limit查询时会将前面所有数据查出,然后去掉前面.所以在大数据量下性能极低</p><p><img src="'+t+'" alt=""></p><h2 id="count" tabindex="-1">count <a class="header-anchor" href="#count" aria-label="Permalink to &quot;count&quot;">​</a></h2><p>count(*) &gt; count(1) &gt; count(primary key) &gt; count(field)</p><h2 id="update" tabindex="-1">update <a class="header-anchor" href="#update" aria-label="Permalink to &quot;update&quot;">​</a></h2><p>innodb 行锁是针对索引,如果update语句where条件没有索引会对该表上锁</p><ul><li>where条件字段应该为索引</li></ul>',40)]))}const b=s(h,[["render",p]]);export{g as __pageData,b as default};
