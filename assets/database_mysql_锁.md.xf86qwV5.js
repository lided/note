import{_ as s,c as i,o as t,ag as e}from"./chunks/framework.DPDPlp3K.js";const l="/assets/Pasted%20image%2020240223185101.CNE8N7iC.png",h="/assets/Pasted%20image%2020240223190855.C7wMKj6V.png",n="/assets/Pasted%20image%2020240223191756.DggQy92o.png",b=JSON.parse('{"title":"全局锁","description":"","frontmatter":{},"headers":[],"relativePath":"database/mysql/锁.md","filePath":"database/mysql/锁.md"}'),r={name:"database/mysql/锁.md"};function p(o,a,d,k,c,g){return t(),i("div",null,a[0]||(a[0]=[e('<h1 id="全局锁" tabindex="-1">全局锁 <a class="header-anchor" href="#全局锁" aria-label="Permalink to &quot;全局锁&quot;">​</a></h1><p>对整个database加锁</p><h6 id="添加全局锁" tabindex="-1">添加全局锁 <a class="header-anchor" href="#添加全局锁" aria-label="Permalink to &quot;添加全局锁&quot;">​</a></h6><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flush tables </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> read</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lock;</span></span></code></pre></div><h6 id="解锁" tabindex="-1">解锁 <a class="header-anchor" href="#解锁" aria-label="Permalink to &quot;解锁&quot;">​</a></h6><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">unlock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tables;</span></span></code></pre></div><h1 id="表级锁" tabindex="-1">表级锁 <a class="header-anchor" href="#表级锁" aria-label="Permalink to &quot;表级锁&quot;">​</a></h1><h2 id="表锁" tabindex="-1">表锁 <a class="header-anchor" href="#表锁" aria-label="Permalink to &quot;表锁&quot;">​</a></h2><ul><li><strong>表共享读锁</strong> 所有人只能读</li><li><strong>表独占写锁</strong> 本人可读写,其他人不可读写</li></ul><h6 id="加表锁" tabindex="-1">加表锁 <a class="header-anchor" href="#加表锁" aria-label="Permalink to &quot;加表锁&quot;">​</a></h6><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">loak tables </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">table_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ read | write ];</span></span></code></pre></div><h6 id="释放表锁" tabindex="-1">释放表锁 <a class="header-anchor" href="#释放表锁" aria-label="Permalink to &quot;释放表锁&quot;">​</a></h6><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">unloak tables;</span></span></code></pre></div><p>断开连接也会释放</p><h2 id="元数据锁-meta-data-loak" tabindex="-1">元数据锁(meta data loak) <a class="header-anchor" href="#元数据锁-meta-data-loak" aria-label="Permalink to &quot;元数据锁(meta data loak)&quot;">​</a></h2><p><img src="'+l+'" alt=""></p><h6 id="查看元数据锁" tabindex="-1">查看元数据锁 <a class="header-anchor" href="#查看元数据锁" aria-label="Permalink to &quot;查看元数据锁&quot;">​</a></h6><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> performance_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">metadata_locks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h2 id="意向锁" tabindex="-1">意向锁 <a class="header-anchor" href="#意向锁" aria-label="Permalink to &quot;意向锁&quot;">​</a></h2><h6 id="查看意向锁" tabindex="-1">查看意向锁 <a class="header-anchor" href="#查看意向锁" aria-label="Permalink to &quot;查看意向锁&quot;">​</a></h6><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> performance_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">data_locks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h1 id="行级锁" tabindex="-1">行级锁 <a class="header-anchor" href="#行级锁" aria-label="Permalink to &quot;行级锁&quot;">​</a></h1><ul><li><strong>行锁</strong> 锁定单行记录</li><li><strong>间隙锁</strong> 锁定记录与记录之间的间隔</li><li><strong>临键锁</strong> 行锁和间隙锁的结合,既锁行也锁相邻前面的间隙</li></ul><h2 id="行锁" tabindex="-1">行锁 <a class="header-anchor" href="#行锁" aria-label="Permalink to &quot;行锁&quot;">​</a></h2><p>innodb实现俩种行锁</p><ul><li><strong>共享锁(S)</strong> 只允许其他用户获取共享锁</li><li><strong>排他锁(X)</strong> 不允许其他用户获取任何行锁(S,X)</li></ul><p>只有共享锁和共享锁互相兼容</p><p><img src="'+h+'" alt=""></p><h6 id="查看行锁" tabindex="-1">查看行锁 <a class="header-anchor" href="#查看行锁" aria-label="Permalink to &quot;查看行锁&quot;">​</a></h6><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> performance_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">data_locks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h2 id="间隙锁" tabindex="-1">间隙锁 <a class="header-anchor" href="#间隙锁" aria-label="Permalink to &quot;间隙锁&quot;">​</a></h2><ul><li></li></ul><p><img src="'+n+'" alt=""></p><p>假设在id为3和6的行中间上间隙锁,则不能给中间插入新数据</p>',34)]))}const m=s(r,[["render",p]]);export{b as __pageData,m as default};
