import{_ as s,c as e,o as t,ag as n}from"./chunks/framework.DPDPlp3K.js";const i="/assets/Pasted%20image%2020240224163936.BsxE5qff.png",l="/assets/Pasted%20image%2020240224171031.Cv_1dyWx.png",g=JSON.parse('{"title":"主从复制","description":"","frontmatter":{},"headers":[],"relativePath":"database/mysql/cluster.md","filePath":"database/mysql/cluster.md"}'),p={name:"database/mysql/cluster.md"};function o(c,a,d,r,h,u){return t(),e("div",null,a[0]||(a[0]=[n('<h1 id="主从复制" tabindex="-1">主从复制 <a class="header-anchor" href="#主从复制" aria-label="Permalink to &quot;主从复制&quot;">​</a></h1><h2 id="原理" tabindex="-1">原理 <a class="header-anchor" href="#原理" aria-label="Permalink to &quot;原理&quot;">​</a></h2><p><img src="'+i+`" alt=""></p><h2 id="start" tabindex="-1">start <a class="header-anchor" href="#start" aria-label="Permalink to &quot;start&quot;">​</a></h2><h3 id="主库配置" tabindex="-1">主库配置 <a class="header-anchor" href="#主库配置" aria-label="Permalink to &quot;主库配置&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#mysql服务id,集群中唯一即可,1~2^32-1</span></span>
<span class="line"><span>server-id=1</span></span>
<span class="line"><span>#是否只读</span></span>
<span class="line"><span>read-only=0</span></span>
<span class="line"><span>#忽略的数据， 指不需要同步的数据库</span></span>
<span class="line"><span>#binlog-ignore-db=mysql</span></span>
<span class="line"><span>#指定同步的数据库</span></span>
<span class="line"><span>#binlog-do-db=db01</span></span></code></pre></div><p>创建远程连接用户并赋予主从复制权限</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>create user &#39;slave&#39; identified by &#39;CYslave@123.&#39;;</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>grant replication slave on *.* to &#39;slave&#39;;</span></span></code></pre></div><p>查看二进制日志坐标位置</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>show master status;</span></span></code></pre></div><p><img src="`+l+`" alt=""></p><h3 id="从库配置" tabindex="-1">从库配置 <a class="header-anchor" href="#从库配置" aria-label="Permalink to &quot;从库配置&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>server-id=2</span></span>
<span class="line"><span>read-only=1</span></span></code></pre></div><p>登录从库,执行</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>change replication source to source_host=&#39;192.168.5.111&#39;,source_user=&#39;slave&#39;,source_password=&#39;CYslave@123.&#39;,source_log_file=&#39;&lt;binlog.000003&gt;&#39;,source_log_pos=693;</span></span></code></pre></div><p>开启主从复制</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>start replica;</span></span></code></pre></div><p>查看主从状态</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>show replica status;</span></span></code></pre></div><h2 id="问题" tabindex="-1">问题 <a class="header-anchor" href="#问题" aria-label="Permalink to &quot;问题&quot;">​</a></h2><blockquote><p>Replica_IO_Running: connecton</p></blockquote><ol><li>检查slave用户能否正常使用</li><li>检查my.cnf配置,server-id不能重复</li><li>检查/var/lib/mysql/auto.cnf中的UUID不能重复</li></ol><h1 id="mycat2" tabindex="-1">mycat2 <a class="header-anchor" href="#mycat2" aria-label="Permalink to &quot;mycat2&quot;">​</a></h1>`,24)]))}const v=s(p,[["render",o]]);export{g as __pageData,v as default};
